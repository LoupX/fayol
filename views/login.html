<!doctype html>
<html lang="es">
<head>
	<meta charset="utf-8" />
	<title>Administración de Fayol</title>
	{{include 'web2py_ajax.html'}}
	<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	
	<!-- Mobile Specific Metas -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" /> 
		
	<!-- CSS -->
	<link rel="stylesheet" href="{{=URL('static','css/base.css')}}" >	
	<link rel="stylesheet" href="{{=URL('static','css/amazium.css')}}">
	<link rel="stylesheet" href="{{=URL('static','css/layout.css')}}">
	<link href='http://fonts.googleapis.com/css?family=Maven+Pro' rel='stylesheet' type='text/css'>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script>
    

</head>
<body>
	<!-- Notificaciones del sistema -->
	<div id="fondo">	
    	<div id="mensaje" class="grid_4 text-center">
        	Error<br>Contrasena o usuario incorrecto.<br><br>
        	<input id="btn" type="button" style="width:90%;" value="Aceptar">
    	</div>
    </div>

    <!-- Sistema -->
	<div class="row">
		<div class="grid_6 text-left titulo" style="height:490px; margin-top:10px;">
			<h1 style="margin-top:80px;">Refaccionaria del Hogar</h1>
	    	<div style="margin-top:60px;">
				{{block my_form}}
		        {{include}}
		        {{end}}
	        	<br>
	        	<span style="color:#999999; font-size:12px;">¿Se te olvidó la contraseña?.
	        		<a href="#">Sigue los siguientes pasos lara.</a></span><br><br>
	        		<span id="err"></span>
	   		</div>
	    </div>

	    <div class="grid_6" style="margin-top:10px; height:480px;">  
	    	<div id="alogo_hype_container" style="position:relative;overflow:hidden;width:440px;height:450px;">
				<script type="text/javascript" src="{{=URL('static','js/alogo_hype_generated_script.js')}}"></script>
			</div>
	    </div>    
	</div>



	<!-- <div class="row" style="height:200px;">
		<div class="grid_12 text-big text-center titulo" style="margin-top:60px;">
	    	<h3>Inicie sesión para administrar el sitio</h3>
	    </div>
	 </div> -->
	 
	 <div class="row" style="margin:auto auto;">
		<div class="grid_12 text-center pie">
			{{block my_footer}}
			{{include}}
			{{end}}	    	
	    </div>
	 </div>

	
    <script type="text/javascript" src="{{=URL('static','js/utf8.js')}}"></script>
    <script type="text/javascript" src="{{=URL('static','js/sh.js')}}"></script>		
	<script>
		jQuery('#inputs input').first().focus() 		//focus al primer input
		var h = (jQuery(document).height()/2)-100;		//coordenadas de la notificacion
		var w = (jQuery(document).width()/2)-150;
		jQuery('#mensaje').css({'margin-left': w, 'margin-top': h});

		//sdfsdfgsdfgsdfg
		jQuery('#submit').live('click', function(e) {
			e.preventDefault();

			
			var usr = jQuery('#usr'),
				pwd = jQuery('#pwd'),
				tkn = jQuery('div.hidden input').val(),
				b_u = false,
				b_p = false;


			if ( usr.val() == "" ) 
			{
				//usr.css({border: '2px solid #e84141'});
				usr
					.attr('placeholder','No puedes dejar vacio este campo')
					.css({
						border: '1px solid #e84141',
						'box-shadow': '0 0 0 1px #e84141 inset',
						'-o-box-shadow': '0 0 0 1px #e84141 inset',
						'-moz-box-shadow': '0 0 0 1px #e84141 inset',
						'-webkit-box-shadow': '0 0 0 1px #e84141 inset',
					});
				b_u = false;
			} 
			else 
			{
				usr
					.attr('placeholder','Usuario')
					.css({
						border: '1px solid #ccc',
						'box-shadow': '0 1px 1px #ccc inset, 0 1px 0 #fff',
						'-o-box-shadow': '0 1px 1px #ccc inset, 0 1px 0 #fff',
						'-moz-box-shadow': '0 1px 1px #ccc inset, 0 1px 0 #fff',
						'-webkit-box-shadow': '0 1px 1px #ccc inset, 0 1px 0 #fff',
					});

				b_u = true;
				usr = sha1( utf8_encode( usr.val() ) ) 
			}

			if ( pwd.val() == "" ) 
			{
				pwd
					.attr('placeholder','No puedes dejar vacio este campo')
					.css({
						border: '1px solid #e84141',
						'box-shadow': '0 0 0 1px #e84141 inset',
						'-o-box-shadow': '0 0 0 1px #e84141 inset',
						'-moz-box-shadow': '0 0 0 1px #e84141 inset',
						'-webkit-box-shadow': '0 0 0 1px #e84141 inset',
					});
				b_p = false;
			} 
			else 
			{ 
				pwd
					.attr('placeholder','Contraseña')
					.css({
						border: '1px solid #ccc',
						'box-shadow': '0 1px 1px #ccc inset, 0 1px 0 #fff',
						'-o-box-shadow': '0 1px 1px #ccc inset, 0 1px 0 #fff',
						'-moz-box-shadow': '0 1px 1px #ccc inset, 0 1px 0 #fff',
						'-webkit-box-shadow': '0 1px 1px #ccc inset, 0 1px 0 #fff',
					});

				pwd = sha1( utf8_encode( pwd.val() ) )
				b_p = true; 
			}

			if( b_u  && b_p ) 
			{
				jQuery.ajax({
					type: 	'POST',
					url: 	'{{=URL('data')}}',
					data: 	{ usr: usr, pwd: pwd, tkn: tkn },
		          	success: function(data) {
			            if(data == 1) 
			            {
			            	jQuery('#fondo').fadeIn("fast");
							jQuery("#mensaje")
								.stop(true)
								.effect("puff", { mode: 'show', percent: 50 }, 200)
								.effect("bounce", { mode: 'show', distance: 25, times: 6, direction: 'down'}, 200);
								//.effect("puff", { mode: 'show', percent: 50 }, 300);
			            }
		          	}
		        });
				//console.log('usr: '+usr+' pwd: '+pwd+' tkn: '+tkn);
			}

			

			//ajax('{{=URL('data')}}', [usr, pwd, tkn], 'actions');

			/*
			*/
		});  
		
		/******************************/		
		
		// Codigo para las notificaciones
		
		
		jQuery('a').click( function() {	
			jQuery('#fondo').fadeIn("fast");
			jQuery("#mensaje")
				.stop(true)
				.effect("puff", { mode: 'show', percent: 50 }, 200)
				.effect("bounce", { mode: 'show', distance: 25, times: 6, direction: 'down'}, 200);
				//.effect("puff", { mode: 'show', percent: 50 }, 300);
		});
		
		jQuery('#btn').click(function(){
				jQuery('#fondo').fadeOut('fast');
				jQuery("#mensaje").slideUp( function() {
				});
		});
		/*************************************************/
	</script>
</body>
</html>